// Модуль менеджера УзлыБинарногоДерева
#Область УправляемыйИнтерфейс

// Создает узел бинарного дерева
//
// Параметры:
//  Вопрос - ПланВидовХарактеристик.ВопросыДляТестирования
//  ЯвляетсяЛистом - Булево
//  Уровень - Число
//
// Возвращаемое значение:
//   СправочникСсылка.УзлыБинарногоДерева
//
Функция СоздатьУзел(Вопрос, ЯвляетсяЛистом = Ложь, Уровень = 0) Экспорт
    
    Узел = Справочники.УзлыБинарногоДерева.СоздатьЭлемент();
    Узел.Наименование = Вопрос.Наименование;
    Узел.Вопрос = Вопрос;
    Узел.ЯвляетсяЛистом = ЯвляетсяЛистом;
    Узел.Уровень = Уровень;
    Узел.Записать();
    
    Возврат Узел;
    
КонецФункции

// Получает корневой узел для шаблона
//
// Параметры:
//  Шаблон - СправочникСсылка.ШаблоныБинарныхДеревьев
//
// Возвращаемое значение:
//   СправочникСсылка.УзлыБинарногоДерева
//
Функция ПолучитьКорневойУзел(Шаблон) Экспорт
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    СтруктураБинарногоДерева.СледующийУзел
    |ИЗ
    |    РегистрСведений.СтруктураБинарногоДерева КАК СтруктураБинарногоДерева
    |ГДЕ
    |    СтруктураБинарногоДерева.ШаблонТеста = &Шаблон
    |    И СтруктураБинарногоДерева.РодительскийУзел = ЗНАЧЕНИЕ(Справочник.УзлыБинарногоДерева.ПустаяСсылка)
    |    И СтруктураБинарногоДерева.ТипОтвета = ЗНАЧЕНИЕ(Перечисление.ТипыОтветовБинарногоДерева.Начальный)";
    
    Запрос.УстановитьПараметр("Шаблон", Шаблон);
    
    Результат = Запрос.Выполнить().Выбрать();
    Если Результат.Следующий() Тогда
        Возврат Результат.СледующийУзел;
    КонецЕсли;
    
    Возврат Неопределено;
    
КонецФункции

#КонецОбласти